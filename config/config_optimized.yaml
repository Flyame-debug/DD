# /content/DD/config/config_optimized_fixed.yaml

augmentation:
  train:
    random_brightness: 0.1  # 降低亮度变化
    random_contrast: 0.1    # 降低对比度变化
    random_horizontal_flip: true
    random_rotation: 10     # 降低旋转角度
    random_crop: false      # 禁用随机裁剪！X光片不能裁剪
    color_jitter: 0.05      # 降低颜色抖动
  val:
    resize_only: true

data:
  image_size: [224, 224]
  mean: [0.485, 0.456, 0.406]
  std: [0.229, 0.224, 0.225]
  test_split: 0.15
  train_split: 0.7
  val_split: 0.15
  cache_images: false

model:
  backbone: "efficientnet-b2"
  dropout_rate: 0.3         # 降低dropout
  num_classes: 14
  pretrained: true
  use_attention: true

training:
  batch_size: 32
  epochs: 40                # 增加epoch
  learning_rate: 0.0003     # 大幅降低学习率！
  weight_decay: 5.0e-05     # 降低权重衰减
  early_stopping_patience: 20
  save_checkpoint_freq: 5
  use_amp: true
  num_workers: 4
  gradient_accumulation_steps: 1
  use_scheduler: "cosine"   # 保持余弦退火

loss:
  name: "weighted_bce"      # 先用加权BCE
  use_focal: false          # 暂时关闭Focal Loss
  # focal_alpha: 0.25       # 注释掉
  # focal_gamma: 2.0        # 注释掉